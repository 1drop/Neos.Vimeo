{"version":3,"sources":["onedrop.vimeo-grid.js"],"names":["arrayIncludes","array","value","indexOf","toArray","thing","Array","prototype","slice","call","sortByDate","element","getAttribute","sortVideoItemsByDate","sort","a","b","Date","releaseTime","createVideoElementFromObject","obj","el","document","createElement","img","img2","overlay","title","setAttribute","window","onedropVimeoGridData","itemClasses","JSON","stringify","albums","link","thumbnail","width","height","textContent","appendChild","addVideoItems","count","itemsToAdd","i","items","length","currentVideoItemCount","shuffleItemsContainer","push","shuffleLoadMoreButton","classList","add","Shuffle","shuffle","Viewport","querySelector","OnedropVimeoGrid","this","querySelectorAll","easing","itemSelector","reverse","by","filters","_bindEventListeners","_onAlbumChange","_handleAlbumChange","bind","forEach","button","addEventListener","_getCurrentAlbumFilters","filter","contains","map","evt","currentTarget","remove","btn","hasActiveFilters","itemPassesFilters","ALL_ITEMS","Object","keys","some","key","filteredAlbums","itemAlbums","parse","hasFilteredAlbum","ID","onedropVimeoGrid","e","preventDefault","newElements"],"mappings":"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","file":"main.js","sourcesContent":["var Shuffle = window.shuffle;\nvar Viewport = window.Viewport;\nvar shuffleItemsContainer = document.querySelector('#vimeo-grid');\nvar shuffleLoadMoreButton = document.querySelector('#loadmore');\nvar currentVideoItemCount = 0;\n\n// ES7 will have Array.prototype.includes.\nfunction arrayIncludes(array, value) {\n    return array.indexOf(value) !== -1;\n}\n\n// Convert an array-like object to a real array.\nfunction toArray(thing) {\n    return Array.prototype.slice.call(thing);\n}\n\nfunction sortByDate(element) {\n    return element.getAttribute('data-release');\n}\n\nvar OnedropVimeoGrid = function (element) {\n    this.albums = toArray(document.querySelectorAll('#vimeo-filters button'));\n\n    this.shuffle = new Shuffle(element, {\n        easing: 'cubic-bezier(0.165, 0.840, 0.440, 1.000)', // easeOutQuart\n        itemSelector: '.item'\n    });\n\n    this.shuffle.sort({\n        reverse: true,\n        by: sortByDate\n    });\n\n    this.filters = {\n        albums: []\n    };\n\n    this._bindEventListeners();\n};\n\n/**\n * Bind event listeners for when the filters change.\n */\nOnedropVimeoGrid.prototype._bindEventListeners = function () {\n    this._onAlbumChange = this._handleAlbumChange.bind(this);\n\n    this.albums.forEach(function (button) {\n        button.addEventListener('click', this._onAlbumChange);\n    }, this);\n};\n\n/**\n * Get the values of each `active` button.\n * @return {Array.<string>}\n */\nOnedropVimeoGrid.prototype._getCurrentAlbumFilters = function () {\n    return this.albums.filter(function (button) {\n        return button.classList.contains('active');\n    }).map(function (button) {\n        return button.getAttribute('data-value');\n    });\n};\n\n/**\n * A album button was clicked. Update filters and display.\n * @param {Event} evt Click event object.\n */\nOnedropVimeoGrid.prototype._handleAlbumChange = function (evt) {\n    var button = evt.currentTarget;\n\n    // Treat these buttons like radio buttons where only 1 can be selected.\n    if (button.classList.contains('active')) {\n        button.classList.remove('active');\n    } else {\n        this.albums.forEach(function (btn) {\n            btn.classList.remove('active');\n        });\n\n        if (button.getAttribute('data-filter') !== '*') {\n            button.classList.add('active');\n        }\n    }\n\n    this.filters.albums = this._getCurrentAlbumFilters();\n    this.filter();\n};\n\n/**\n * Filter shuffle based on the current state of filters.\n */\nOnedropVimeoGrid.prototype.filter = function () {\n    if (this.hasActiveFilters()) {\n        this.shuffle.filter(this.itemPassesFilters.bind(this));\n    } else {\n        this.shuffle.filter(Shuffle.ALL_ITEMS);\n    }\n};\n\n/**\n * If any of the arrays in the `filters` property have a length of more than zero,\n * that means there is an active filter.\n * @return {boolean}\n */\nOnedropVimeoGrid.prototype.hasActiveFilters = function () {\n    return Object.keys(this.filters).some(function (key) {\n        return this.filters[key].length > 0;\n    }, this);\n};\n\n/**\n * Determine whether an element passes the current filters.\n * @param {Element} element Element to test.\n * @return {boolean} Whether it satisfies all current filters.\n */\nOnedropVimeoGrid.prototype.itemPassesFilters = function (element) {\n    var filteredAlbums = this.filters.albums;\n    var itemAlbums = JSON.parse(element.getAttribute('data-album'));\n\n    if (filteredAlbums[0] != null && filteredAlbums.length > 0) {\n        var hasFilteredAlbum = false;\n        for (var i = 0; i < itemAlbums.length; i++) {\n            if (arrayIncludes(filteredAlbums, itemAlbums[i].ID)) {\n                hasFilteredAlbum = true;\n            }\n        }\n        return hasFilteredAlbum;\n    }\n    return true;\n};\n\nfunction sortVideoItemsByDate(array) {\n    array.sort(function (a, b) {\n        // Turn your strings into dates, and then subtract them\n        // to get a value that is either negative, positive, or zero.\n        return new Date(b.releaseTime) - new Date(a.releaseTime);\n    });\n    return array;\n}\n\nfunction createVideoElementFromObject(obj) {\n    var el = document.createElement(\"div\");\n    var a = document.createElement(\"a\");\n    var img = document.createElement(\"img\");\n    var img2 = document.createElement(\"img\");\n    var overlay = document.createElement(\"div\");\n    var title = document.createElement(\"span\");\n\n    el.setAttribute(\"class\", window.window.onedropVimeoGridData.itemClasses);\n    el.setAttribute(\"data-album\", JSON.stringify(obj.albums));\n    el.setAttribute(\"data-release\", obj.releaseTime);\n    el.setAttribute(\"data-title\", obj.title);\n    a.setAttribute(\"href\", obj.link);\n    a.setAttribute(\"class\", \"item__inner embed-responsive embed-responsive-16by9\");\n    img.setAttribute(\"src\", obj.thumbnail.link);\n    img.setAttribute(\"width\", obj.thumbnail.width);\n    img.setAttribute(\"height\", obj.thumbnail.height);\n    img.setAttribute(\"alt\", obj.title);\n    img.setAttribute(\"class\", \"embed-responsive-item\");\n    img2.setAttribute(\"src\", obj.thumbnail.link);\n    img2.setAttribute(\"width\", obj.thumbnail.width);\n    img2.setAttribute(\"height\", obj.thumbnail.height);\n    img2.setAttribute(\"alt\", obj.title);\n    img2.setAttribute(\"class\", \"embed-responsive-item hover-effect\");\n    overlay.setAttribute(\"class\", \"item-overlay\");\n    title.setAttribute(\"class\", \"title\");\n    title.textContent = obj.title;\n\n    overlay.appendChild(title);\n    a.appendChild(img);\n    a.appendChild(img2);\n    a.appendChild(overlay);\n    el.appendChild(a);\n\n    return el;\n}\n\nfunction addVideoItems(count) {\n    var itemsToAdd = [];\n    for (var i = 0; i < count; i++) {\n        if (window.window.onedropVimeoGridData.items.length > currentVideoItemCount + i) {\n            var el = createVideoElementFromObject(window.window.onedropVimeoGridData.items[currentVideoItemCount + i]);\n            shuffleItemsContainer.appendChild(el);\n            itemsToAdd.push(el);\n        } else {\n            shuffleLoadMoreButton.classList.add('disabled');\n        }\n    }\n    currentVideoItemCount += itemsToAdd.length;\n    return itemsToAdd;\n}\n\n// sort items by date\nwindow.window.onedropVimeoGridData.items = sortVideoItemsByDate(window.window.onedropVimeoGridData.items);\n\n// add 9 items to dom\naddVideoItems(9);\n\n// initialize shufflejs\nwindow.onedropVimeoGrid = new OnedropVimeoGrid(shuffleItemsContainer);\n\n// load more items on click\nshuffleLoadMoreButton.addEventListener('click', function (e) {\n    e.preventDefault();\n    var newElements = addVideoItems(9);\n    window.onedropVimeoGrid.shuffle.add(newElements);\n});\n"]}